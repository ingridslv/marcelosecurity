(()=>{function t(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var o,i,r,a,s=[],p=!0,u=!1;try{if(r=(e=e.call(t)).next,0===n){if(Object(e)!==e)return;p=!1}else for(;!(p=(o=r.call(e)).done)&&(s.push(o.value),s.length!==n);p=!0);}catch(t){u=!0,i=t}finally{try{if(!p&&null!=e.return&&(a=e.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}(t,e)||function(t,e){if(t){if("string"==typeof t)return n(t,e);var o={}.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?n(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,o=Array(n);e<n;e++)o[e]=t[e];return o}var e=function(t){return this.popup=t.popup,this.popupContent=null,this.map=t.map||null,this.contentIsSet=function(){return null!==this.popupContent},this.close=function(){},this.setMap=function(t){this.map=t},this.draw=function(){},this.open=function(t,n){},this.setContent=function(t){this.popupContent=t,this.popup.setHTML(t)},this};window.JetEngineMapsProvider=function(){this._activePopup=null,this.getId=function(){return"mapbox"},this.getContainer=function(t){return t.getContainer()},this.getBoundsJSON=function(t){var n=t.getBounds();if(n)return{east:n.getEast(),north:n.getNorth(),south:n.getSouth(),west:n.getWest()}},this.updateSyncBounds=function(){var t=this.getBounds();t&&window.JetEngineMaps.dispatchMapSyncEvent(this,{east:t.getEast(),north:t.getNorth(),south:t.getSouth(),west:t.getWest()})},this.initSync=function(t){null!=t&&t.isJetEngineSyncInited||!window.JetEngineMaps||!window.JetSmartFilters||(t.on("zoomend",this.updateSyncBounds),t.on("moveend",this.updateSyncBounds),t.on("resize",this.updateSyncBounds),t.once("load",function(){window.JetEngineMaps.dispatchMapSyncInitEvent(t)}),t.isJetEngineSyncInited=!0)},this.initMap=function(n,e){e=e||{};for(var o={},i=0,r=Object.entries({zoom:"zoom",center:"center",cooperativeGestures:"scrollwheel",zoomControl:"zoomControl",style:"styles",maxZoom:"maxZoom",minZoom:"minZoom"});i<r.length;i++){var a=t(r[i],2),s=a[0],p=a[1];void 0!==e[p]&&(o[s]=e[p])}o.center&&(o.center={lon:o.center.lng,lat:o.center.lat}),n.id?o.container=n.id:o.container=n,o.style||(o.style="mapbox://styles/mapbox/streets-v11"),mapboxgl.accessToken=window.JetEngineMapboxData.token;var u=new mapboxgl.Map(o);return this.initSync(u),u},this.initBounds=function(){return new mapboxgl.LngLatBounds},this.getMarkerPosition=function(t,n){return t.getLngLat()},this.fitMapBounds=function(t){t.map.fitBounds(t.bounds,{padding:{top:20,bottom:20,left:20,right:20},duration:0})},this.addMarker=function(t){var n=document.createElement("div");n.className="jet-map-marker",n.offsetWidth=32,n.innerHTML=t.content;var e=new mapboxgl.Marker(n).setLngLat([t.position.lng,t.position.lat]);return t.markerClustering||e.addTo(t.map),e},this.removeMarker=function(t){t.remove()},this.markerOnClick=function(t,n,e){var o=this;(n=n||{}).map=t,n.shadow=!1,t.on("click",function(t){n.position={lat:t.lngLat.lat,lng:t.lngLat.lng},e&&e(o.addMarker(n))})},this.closePopup=function(t,n){t.popup.on("close",function(){n()})},this.openPopup=function(t,n,e,o,i){var r=this;e.popup.on("open",function(){o.isInternalInteraction=!0,n(),r._activePopup=e.popup}),t.setPopup(e.popup),"hover"===i&&t.getElement().addEventListener("mouseenter",function(){o.isInternalInteraction=!0,r.triggerOpenPopup(t)})},this.triggerOpenPopup=function(t){t._map&&(this._activePopup&&this._activePopup.remove(),t.getPopup().isOpen()||t.togglePopup())},this.getMarkerCluster=function(t){return new JetMapboxMarkerClusterer(t)},this.addMarkers=function(t,n){t.setMarkers(n),t.setMapData()},this.removeMarkers=function(t,n){t.removeMarkers()},this.setCenterByPosition=function(t){t.map.jumpTo({center:t.position,zoom:t.zoom})},this.getMapZoom=function(t){return t.getZoom()},this.setAutoCenter=function(t){t.map.isInternalInteraction=!0,this.fitMapBounds(t)},this.addPopup=function(t){var n=new mapboxgl.Popup({maxWidth:t.width+"px",minWidth:t.width+"px",offset:t.offset,focusAfterOpen:!0,className:"jet-map-box"});return new e({popup:n})},this.getMarkerMap=function(t){return t._map},this.fitMapToMarker=function(t,n,e){var o=this,i=n.map;e||(e=10);var r=function(){var a;t._map?o.triggerOpenPopup(t):(e++,null!==(a=t.fitMapToMarkerTries)&&void 0!==a||(t.fitMapToMarkerTries=0),t.fitMapToMarkerTries++,t.fitMapToMarkerTries<3?o.fitMapToMarker(t,n,e):(t.fitMapToMarkerTries=0,o.triggerOpenPopup(t))),i.off("idle",r)};this._activePopup&&this._activePopup.remove(),this.panTo({map:i,position:this.getMarkerPosition(t),zoom:e}),i.on("idle",r)},this.panTo=function(t){t.map.flyTo({center:t.position,zoom:t.zoom&&t.zoom>t.map.getZoom()?t.zoom:t.map.getZoom()})}}})();