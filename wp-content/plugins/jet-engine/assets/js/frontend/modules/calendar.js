(()=>{const e=jQuery;function t(e){let t=e.querySelector(".jet-calendar-caption__date-select.select-month"),n=e.querySelector(".jet-calendar-caption__date-select.select-year");if(!t||!n)return!1;let a=e.querySelector(".jet-calendar-caption__date-select-label.select-month"),i=e.querySelector(".jet-calendar-caption__date-select-label.select-year");e.setAttribute("data-month",t.value+" "+n.value);const r=t.querySelector(`option[value="${t.value}"]`),c=n.querySelector(`option[value="${n.value}"]`);return a.innerHTML=r.innerHTML,i.innerHTML=c.innerHTML,!0}function n(t){t.preventDefault(),t.stopPropagation();var n=e(t.currentTarget),a=n.data("object-id"),i=n.closest(".jet-calendar").find(`.jet-md-calendar__event-content[data-object-id="${a}"]`);i.length&&(JetEngine.closeCalendarEvents(),i.addClass("is-active"))}function a(t){t&&(t.preventDefault(),t.stopPropagation()),e(".jet-md-calendar__event-content").removeClass("is-active")}function i(t){var n=e(this).closest(".jet-calendar-week__day"),a=n.closest(".jet-calendar-week"),i=n.find(".jet-calendar-week__day-content"),r="calendar-event-active";if(n.hasClass(r))return n.removeClass(r),JetEngine.activeCalendarDay.remove(),void(JetEngine.activeCalendarDay=null);JetEngine.activeCalendarDay&&(JetEngine.activeCalendarDay.remove(),e("."+r).removeClass(r),JetEngine.activeCalendarDay=null),n.addClass("calendar-event-active"),JetEngine.activeCalendarDay=e('<tr class="jet-calendar-week"><td colspan="7" class="jet-calendar-week__day jet-calendar-week__day-mobile"><div class="jet-calendar-week__day-mobile-event">'+i.html()+"</div></td></tr>"),JetEngine.activeCalendarDay.find(".jet-popup-attach-event-inited").removeClass("jet-popup-attach-event-inited"),JetEngine.initElementsHandlers(JetEngine.activeCalendarDay),JetEngine.activeCalendarDay.insertAfter(a)}function r(t){var n=e(this),a=n.closest(".jet-calendar"),i=n.closest(".elementor-widget"),r=i.closest(".elementor-widget").data("id"),c=a.data("settings"),l=a.data("post"),s=n.data("month");(c=JetEngine.ensureJSON(c)).renderer=a.data("renderer")||"",this.classList.contains("nav-link-prev")?c.__switch_direction=-1:this.classList.contains("nav-link-next")?c.__switch_direction=1:c.__switch_direction=0;let d="elementor";i.length||(i=a.closest(".jet-listing-calendar-block"),d="block"),i.length||(i=a.closest(".brxe-jet-listing-calendar"),r=i.data("element-id"),d="bricks"),JetEngine.calendarCache.modifyJetSmartFiltersSetiings(i,d,s);const o=a.data("cache-id")||!1,g=1e3*(c.cache_timeout??0);if(o&&g){JetEngine.calendarCache.deleteExpiredEntries(o,g),window.bricksIsFrontend&&a.find(".accordion-item.listening, .brxe-accordion-nested > .listening").removeClass("listening brx-open"),JetEngine.calendarCache.update(o,c.prev_month,a.prop("outerHTML"),c);const t=JetEngine.calendarCache.get(o,s);if(t?.length&&t[0]&&!JetEngine.calendarCache.isExpired(o,s,g)){let n=e(t[0]);return n.removeClass("jet-calendar-loading"),a.replaceWith(n[0]),JetEngine.initElementsHandlers(i),JetEngine.updateDateSelectLabels(i[0]),JetEngine.reinitBricksScripts(r),void e(document).trigger("jet-engine-request-calendar-cached",[i])}}a.addClass("jet-calendar-loading"),JetEngine.currentRequest={jet_engine_action:"jet_engine_calendar_get_month",month:s,settings:c,post:l},e(document).trigger("jet-engine-request-calendar"),e.ajax({url:JetEngineSettings.ajaxlisting,type:"POST",dataType:"json",data:JetEngine.currentRequest}).done(function(t){t.success&&(a.replaceWith(t.data.content),o&&g&&JetEngine.calendarCache.set(o,s,t.data.content,c),JetEngine.initElementsHandlers(i),JetEngine.reinitBricksScripts(r),e(document).trigger("jet-engine-request-calendar-done",[i])),a.removeClass("jet-calendar-loading")})}function c(e){let t=this.closest(".jet-calendar-caption__dates");JetEngine.updateDateSelectLabels(t)&&JetEngine.switchCalendarMonth.bind(t)()}window.JetPlugins.hooks.addAction("jet-engine.modules-include","module-calendar",function(e){e.activeCalendarDay=null,e.currentMonth=null,e.currentRequest={},e.calendarCache=l,e.selectCalendarMonth=c,e.switchCalendarMonth=r,e.showCalendarEvent=i,e.openCalendarEvent=n,e.closeCalendarEvents=a,e.updateDateSelectLabels=t}),window.JetPlugins.hooks.addAction("jet-engine.common-events","module-calendar",function(e,t){e.on("jet-filter-content-rendered",t.calendarCache.clear).on("change.JetEngine",".jet-calendar-caption__date-select",t.selectCalendarMonth).on("click.JetEngine",".jet-calendar-nav__link",t.switchCalendarMonth).on("click.JetEngine",".jet-calendar-week__day-mobile-overlay",t.showCalendarEvent).on("click.JetEngine",".jet-md-calendar__event",t.openCalendarEvent).on("click.JetEngine",".jet-md-calendar__event-overlay, .jet-md-calendar__event-close",t.closeCalendarEvents)});const l={entries:{},iterate:function(e,t){if("function"==typeof e?.forEach)e.forEach(t);else if("function"==typeof e?.next){let n;for(;n=e.next(),!n.done;)t.call(this,n.value)}},get:function(e,t){return JetEngine.calendarCache.entries[e]?.get(t)||!1},set:function(e,t,n,a={},i=!1){if(JetEngine.calendarCache.entries[e]||(JetEngine.calendarCache.entries[e]=new Map),!JetEngine.calendarCache.entries[e].has(t)&&JetEngine.calendarCache.entries[e].size>(a.max_cache??12)-1){let t;const n=JetEngine.calendarCache.entries[e].keys();if(a.__switch_direction<0){let e=!1;JetEngine.calendarCache.iterate(n,function(n){const a=Date.parse(n);(!e||a>e)&&(e=a,t=n)})}else{let e=!1;JetEngine.calendarCache.iterate(n,function(n){const a=Date.parse(n);(!e||a<e)&&(e=a,t=n)})}JetEngine.calendarCache.entries[e].delete(t)}i||(i=Date.now()),JetEngine.calendarCache.entries[e].set(t,[n,i])},update:function(e,t,n,a={}){let i=JetEngine.calendarCache.get(e,t);JetEngine.calendarCache.set(e,t,n,a,i[1]??!1)},deleteExpiredEntries:function(e,t){for(const e in JetEngine.calendarCache.entries)document.querySelector(`.jet-calendar[data-cache-id="${e}"]`)||delete JetEngine.calendarCache.entries[e];JetEngine.calendarCache.entries[e]&&JetEngine.calendarCache.iterate(JetEngine.calendarCache.entries[e].keys(),function(n){JetEngine.calendarCache.isExpired(e,n,t)&&JetEngine.calendarCache.entries[e].delete(n)})},isExpired:function(e,t,n){if(n<0)return!1;const a=JetEngine.calendarCache.get(e,t);return!a||!Array.isArray(a)||!a[1]||a[1]<Date.now()-n},clear:function(e,t){const n=t.data("cache-id")||!1;n&&(JetEngine.calendarCache.entries[n]=new Map)},modifyJetSmartFiltersSetiings:function(e,t,n){if(!window.JetSmartFilterSettings||!window.JetSmartFilterSettings.settings)return;if(!window.JetSmartFilterSettings.settings["jet-engine-calendar"])return;const a=(n=n.split(" "))[0],i=n[1];let r;switch(t){case"block":r=e.closest(".jet-listing-calendar-block")[0].id,r||(r="default"),window.JetSmartFilterSettings.settings["jet-engine-calendar"][r]&&(window.JetSmartFilterSettings.settings["jet-engine-calendar"][r].start_from_month=a,window.JetSmartFilterSettings.settings["jet-engine-calendar"][r].start_from_year=i);break;case"bricks":if(r=e.data("element-id"),!r)break;for(const e in window.JetSmartFilterSettings.settings["jet-engine-calendar"])if(window.JetSmartFilterSettings.settings["jet-engine-calendar"][e]?._id===r){window.JetSmartFilterSettings.settings["jet-engine-calendar"][e].start_from_month=a,window.JetSmartFilterSettings.settings["jet-engine-calendar"][e].start_from_year=i;break}break;case"elementor":r=e.closest(".elementor-widget-jet-listing-calendar")[0].id,r||(r="default"),window.JetSmartFilterSettings.settings["jet-engine-calendar"]?.[r]&&(window.JetSmartFilterSettings.settings["jet-engine-calendar"][r].start_from_month=a,window.JetSmartFilterSettings.settings["jet-engine-calendar"][r].start_from_year=i)}}}})();